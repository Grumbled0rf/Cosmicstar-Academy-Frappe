{"version":3,"file":"CertifiedParticipants-D9CEo6kq.js","sources":["../../../../frontend/src/pages/CertifiedParticipants.vue"],"sourcesContent":["<template>\n\t<header\n\t\tclass=\"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t\t<router-link :to=\"{ name: 'Batches', query: { certification: true } }\">\n\t\t\t<Button>\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<GraduationCap class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t</template>\n\t\t\t\t{{ __('Get Certified') }}\n\t\t\t</Button>\n\t\t</router-link>\n\t</header>\n\t<div class=\"mx-auto w-full max-w-4xl pt-6 pb-10\">\n\t\t<div class=\"flex flex-col md:flex-row justify-between mb-4 px-3\">\n\t\t\t<div class=\"text-xl font-semibold text-ink-gray-7 mb-4 md:mb-0\">\n\t\t\t\t{{ memberCount }} {{ __('certified members') }}\n\t\t\t</div>\n\t\t\t<div class=\"grid grid-cols-2 gap-2\">\n\t\t\t\t<FormControl\n\t\t\t\t\tv-model=\"nameFilter\"\n\t\t\t\t\t:placeholder=\"__('Search by Name')\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tclass=\"min-w-40 lg:min-w-0 lg:w-32 xl:w-40\"\n\t\t\t\t\t@input=\"updateParticipants()\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"categories.data?.length\"\n\t\t\t\t\tclass=\"min-w-40 lg:min-w-0 lg:w-32 xl:w-40\"\n\t\t\t\t>\n\t\t\t\t\t<Select\n\t\t\t\t\t\tv-model=\"currentCategory\"\n\t\t\t\t\t\t:options=\"categories.data\"\n\t\t\t\t\t\t:placeholder=\"__('Category')\"\n\t\t\t\t\t\t@change=\"updateParticipants()\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-if=\"participants.data?.length\" class=\"divide-y\">\n\t\t\t<template v-for=\"participant in participants.data\">\n\t\t\t\t<router-link\n\t\t\t\t\t:to=\"{\n\t\t\t\t\t\tname: 'ProfileCertificates',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tusername: participant.username,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\"\n\t\t\t\t\tclass=\"flex sm:rounded px-3 py-2 sm:h-15 hover:bg-surface-gray-2\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"flex items-center w-full space-x-3\">\n\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t:image=\"participant.user_image\"\n\t\t\t\t\t\t\tclass=\"size-8 rounded-full object-contain\"\n\t\t\t\t\t\t\t:label=\"participant.full_name\"\n\t\t\t\t\t\t\tsize=\"2xl\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"flex flex-col md:flex-row w-full\">\n\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t<div class=\"text-base font-medium text-ink-gray-8\">\n\t\t\t\t\t\t\t\t\t{{ participant.full_name }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"participant.headline\"\n\t\t\t\t\t\t\t\t\tclass=\"mt-1.5 text-base text-ink-gray-5\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{ participant.headline }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"flex items-center space-x-3 md:space-x-24 text-sm md:text-base mt-1.5\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"text-ink-gray-5\">\n\t\t\t\t\t\t\t\t\t{{ participant.certificate_count }}\n\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\tparticipant.certificate_count > 1\n\t\t\t\t\t\t\t\t\t\t\t? __('certificates')\n\t\t\t\t\t\t\t\t\t\t\t: __('certificate')\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span class=\"text-ink-gray-4 md:hidden\">Â·</span>\n\t\t\t\t\t\t\t\t<div class=\"text-ink-gray-5\">\n\t\t\t\t\t\t\t\t\t{{ dayjs(participant.issue_date).format('DD MMM YYYY') }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</router-link>\n\t\t\t</template>\n\t\t</div>\n\t\t<EmptyState v-else type=\"Certified Members\" />\n\t\t<div\n\t\t\tv-if=\"!participants.list.loading && participants.hasNextPage\"\n\t\t\tclass=\"flex justify-center mt-5\"\n\t\t>\n\t\t\t<Button @click=\"participants.next()\">\n\t\t\t\t{{ __('Load More') }}\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tAvatar,\n\tBreadcrumbs,\n\tButton,\n\tcall,\n\tcreateListResource,\n\tFormControl,\n\tSelect,\n\tusePageMeta,\n} from 'frappe-ui'\nimport { computed, inject, onMounted, ref } from 'vue'\nimport { GraduationCap } from 'lucide-vue-next'\nimport { sessionStore } from '../stores/session'\nimport EmptyState from '@/components/EmptyState.vue'\n\nconst currentCategory = ref('')\nconst filters = ref({})\nconst nameFilter = ref('')\nconst { brand } = sessionStore()\nconst memberCount = ref(0)\nconst dayjs = inject('$dayjs')\n\nonMounted(() => {\n\tgetMemberCount()\n\tupdateParticipants()\n})\n\nconst participants = createListResource({\n\tdoctype: 'LMS Certificate',\n\turl: 'lms.lms.api.get_certified_participants',\n\tstart: 0,\n\tpageLength: 100,\n})\n\nconst getMemberCount = () => {\n\tcall('lms.lms.api.get_count_of_certified_members', {\n\t\tfilters: filters.value,\n\t}).then((data) => {\n\t\tmemberCount.value = data\n\t})\n}\n\nconst categories = createListResource({\n\tdoctype: 'LMS Certificate',\n\turl: 'lms.lms.api.get_certification_categories',\n\tcache: ['certification_categories'],\n\tauto: true,\n\ttransform(data) {\n\t\tdata.unshift({ label: __(''), value: '' })\n\t\treturn data\n\t},\n})\n\nconst updateParticipants = () => {\n\tupdateFilters()\n\tgetMemberCount()\n\tparticipants.update({\n\t\tfilters: filters.value,\n\t})\n\tparticipants.reload()\n}\n\nconst updateFilters = () => {\n\tif (currentCategory.value) {\n\t\tfilters.value.category = currentCategory.value\n\t} else {\n\t\tdelete filters.value.category\n\t}\n\n\tif (nameFilter.value) {\n\t\tfilters.value.member_name = ['like', `%${nameFilter.value}%`]\n\t} else {\n\t\tdelete filters.value.member_name\n\t}\n}\n\nconst breadcrumbs = computed(() => [\n\t{\n\t\tlabel: __('Certified Members'),\n\t\troute: { name: 'CertifiedParticipants' },\n\t},\n])\n\nusePageMeta(() => {\n\treturn {\n\t\ttitle: __('Certified Members'),\n\t\ticon: brand.favicon,\n\t}\n})\n</script>\n<style>\n.headline {\n\tdisplay: -webkit-box;\n\t-webkit-line-clamp: 1;\n\t-webkit-box-orient: vertical;\n\ttext-overflow: ellipsis;\n\twidth: 100%;\n\toverflow: hidden;\n}\n</style>\n"],"names":["currentCategory","ref","filters","nameFilter","brand","sessionStore","memberCount","dayjs","inject","onMounted","getMemberCount","updateParticipants","participants","createListResource","call","data","categories","updateFilters","breadcrumbs","computed","usePageMeta"],"mappings":"gtCAsHA,MAAMA,EAAkBC,EAAI,EAAE,EACxBC,EAAUD,EAAI,CAAE,CAAA,EAChBE,EAAaF,EAAI,EAAE,EACnB,CAAE,MAAAG,CAAO,EAAGC,EAAY,EACxBC,EAAcL,EAAI,CAAC,EACnBM,EAAQC,EAAO,QAAQ,EAE7BC,EAAU,IAAM,CACfC,EAAc,EACdC,EAAkB,CACnB,CAAC,EAED,MAAMC,EAAeC,EAAmB,CACvC,QAAS,kBACT,IAAK,yCACL,MAAO,EACP,WAAY,GACb,CAAC,EAEKH,EAAiB,IAAM,CAC5BI,EAAK,6CAA8C,CAClD,QAASZ,EAAQ,KACnB,CAAE,EAAE,KAAMa,GAAS,CACjBT,EAAY,MAAQS,CACpB,CAAA,CACF,EAEMC,EAAaH,EAAmB,CACrC,QAAS,kBACT,IAAK,2CACL,MAAO,CAAC,0BAA0B,EAClC,KAAM,GACN,UAAUE,EAAM,CACf,OAAAA,EAAK,QAAQ,CAAE,MAAO,GAAG,EAAE,EAAG,MAAO,EAAI,CAAA,EAClCA,CACP,CACF,CAAC,EAEKJ,EAAqB,IAAM,CAChCM,EAAa,EACbP,EAAc,EACdE,EAAa,OAAO,CACnB,QAASV,EAAQ,KACjB,CAAA,EACDU,EAAa,OAAM,CACpB,EAEMK,EAAgB,IAAM,CACvBjB,EAAgB,MACnBE,EAAQ,MAAM,SAAWF,EAAgB,MAEzC,OAAOE,EAAQ,MAAM,SAGlBC,EAAW,MACdD,EAAQ,MAAM,YAAc,CAAC,OAAQ,IAAIC,EAAW,KAAK,GAAG,EAE5D,OAAOD,EAAQ,MAAM,WAEvB,EAEMgB,EAAcC,EAAS,IAAM,CAClC,CACC,MAAO,GAAG,mBAAmB,EAC7B,MAAO,CAAE,KAAM,uBAAyB,CACxC,CACF,CAAC,EAED,OAAAC,EAAY,KACJ,CACN,MAAO,GAAG,mBAAmB,EAC7B,KAAMhB,EAAM,OACd,EACC"}